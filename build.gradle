task wrapper(type: Wrapper) {
    gradleVersion = '2.5'
}


configurations.all {
    // dynamic: e.g. 'version: 2.0+'
    resolutionStrategy.cacheDynamicVersionsFor 1, 'hours'
    // changing: e.g. 'version 2.0.0-SNAPSHOT'
    resolutionStrategy.cacheChangingModulesFor 10, 'minutes'
}

repositories {
    maven { url "http://repo.dotcms.com/artifactory/libs-release" }
    maven { url "http://repo.dotcms.com/artifactory/libs-snapshot-local" }
}

task cleanPre3_5_Files(type: Delete) {
    delete "${project.projectDir}/dotCMS/WEB-INF/lib",
            "${project.projectDir}/dotCMS/WEB-INF/classes",
            "${project.projectDir}/dotCMS/WEB-INF/felix/bundle",
            "${project.projectDir}/dotCMS/starter.zip"
}


def usePre3_5Build(){
    logger.info("Building with pre3.5 Ant build system.")
    //Import and apply the dependencies from the dependencies scripts
    apply from: "$rootDir/build-pre3_5-ant.gradle"
}

def usePureGradleBuild(){
    logger.info("Building with incubating Gradle build: ")
    clean.dependsOn cleanPre3_5_Files
    apply from: "${rootDir}/core.gradle"
}

if(project.'com.dotcms.build.use-pre-3_5-build' == 'true'){
    usePre3_5Build()
} else {
    usePureGradleBuild()
}


defaultTasks 'help', 'tasks'

